from api_interface.request_engine import RequestEngine


class CSRFCheck:
    def __init__(self, requestEngine: RequestEngine, samplePayload) -> None:
        self.requestEngine = requestEngine
        self.samplePayload = samplePayload

    def check_csrf(self, csrf_token) -> bool:
        response = self.requestEngine.send_request(
            headers={
                "accept": "text/html,application/xhtml+xml,application/xml",
                "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36",
            },
            params=self.samplePayload,
            log_details=False,
        )
        return bool(response["cookies"].get(csrf_token))
